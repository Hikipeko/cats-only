{% extends "base.html" %}

{% block content %}
<h2>{{ username }}</h2>
{% if logname == username %}
{% else %}
{% if logname_follows_username %}
<p>following</p>
<form action="/following/?target=/users/{{ username }}/" method="post" enctype="multipart/form-data">
  <input type="submit" name="unfollow" value="unfollow" />
  <input type="hidden" name="username" value="{{ username }}" />
  <input type="hidden" name="operation" value="unfollow" />
</form>
{% else %}
<p>not following</p>
<form action="/following/?target=/users/{{ username }}/" method="post" enctype="multipart/form-data">
  <input type="submit" name="follow" value="follow" />
  <input type="hidden" name="username" value="{{ username }}" />
  <input type="hidden" name="operation" value="follow" />
</form>
{% endif %}
{% endif %}

<!-- Link to /accounts/edit/ -->
{% if logname == username %}
<div>
  <a href="/accounts/edit/">
    Edit profile
  </a>
</div>
{% endif %}

<!-- logout form -->
{% if logname == username %}
<div>
  <form action="/accounts/logout/" method="post" enctype="multipart/form-data">
    <input type="submit" name="logout" value="Logout" />
  </form>
</div>
{% endif %}

<p>
  {{ total_posts }}
  {% if total_posts == 1 %}
  post
  {% else %}
  posts
  {% endif %}
  <a href="/users/{{ username }}/followers/">
    <b>
      {{ followers }}
      {% if followers == 1 %}
      follower
      {% else %}
      followers
      {% endif %}
    </b>
  </a>
  <a href="/users/{{ username }}/following/">{{ following }} following</a>
</p>
<p>{{ fullname }}</p>

<!-- upload new post form -->
{% if logname == username %}
<div>
  <form action="/posts/?target=/users/{{ username }}/" method="post" enctype="multipart/form-data">
    <input type="file" name="file" accept="image/*" required />
    <input type="submit" name="create_post" value="upload new post" />
    <input type="hidden" name="operation" value="create" />
  </form>
</div>
{% endif %}

{% for post in posts %}
<a href="/posts/{{ post.postid }}/">
  <img src="/uploads/{{ post.img_url }}" alt="{{ post.img_url }}">
</a>
{% endfor %}

{% endblock content %}